(function(n){n.widget("ui.carousel",{version:"0.5.2",oldClass:null,options:{itemsPerPage:"auto",itemsPerTransition:"auto",orientation:"horizontal",noOfRows:1,unknownHeight:!1,pagination:!0,insertPagination:null,nextPrevActions:!0,insertNextAction:null,insertPrevAction:null,speed:"normal",easing:"swing",startAt:null,beforeAnimate:null,afterAnimate:null},_create:function(){this.itemIndex=0,this._elements(),this._addClasses(),this._defineOrientation(),this._addMask(),this._setMaskDim(),this._setItemDim(),this._setItemsPerPage(),this._setNoOfItems(),this._setNoOfPages(),this._setRunnerWidth(),this._setMaskHeight(),this._setLastPos(),this._addControlsOuterWrapper(),this._addControlsWrapper(),this._addPrevAction(),this._addPagination(),this._addNextAction(),this.options.startAt&&this.goTo(this.options.startAt),this._updateUi()},_elements:function(){var n=this.elements={};n.mask=this.element.find(".mask"),n.runner=this.element.find(".t"),n.items=n.runner.children(".tile"),n.pagination=null,n.nextAction=null,n.prevAction=null},_addClasses:function(){this.oldClass||(this.oldClass=this.element.attr("class")),this._removeClasses();var t=this.widgetBaseClass,n=[];n.push(t),n.push(t+"-"+this.options.orientation),n.push(t+"-items-"+this.options.itemsPerPage),n.push(t+"-rows-"+this.options.noOfRows),this.element.addClass(n.join(" "))},_removeClasses:function(){var r=this,u=[],t,i;this.element.removeClass(function(f,e){return e=e.split(" "),n.each(e,function(n){t=e[n],i=t.split("-"),i[0]===r.namespace&&i[1]===r.widgetName&&u.push(t)}),u.join(" ")})},_defineOrientation:function(){this.options.orientation==="horizontal"?(this.horizontal=!0,this.helperStr={pos:"left",pos2:"right",dim:"width"}):(this.horizontal=!1,this.helperStr={pos:"top",pos2:"bottom",dim:"height"},this.options.noOfRows=1)},_addMask:function(){var n=this.elements;n.mask.length||(n.mask=n.runner.wrap('<div class="mask" />').parent(),this.maskAdded=!0)},_setMaskDim:function(){this.maskDim=this.elements.mask[this.helperStr.dim]()},_setMaskHeight:function(){if(this.horizontal&&this.options.unknownHeight){var n=this.elements,t=n.runner.outerHeight(!0);n.mask.height(t)}},_setItemDim:function(){this.itemDim=this.elements.items["outer"+this.helperStr.dim.charAt(0).toUpperCase()+this.helperStr.dim.slice(1)](!0)},_setItemsPerPage:function(){this.itemsPerPage=typeof this.options.itemsPerPage=="number"?this.options.itemsPerPage:Math.floor(this.maskDim/this.itemDim)},_setNoOfItems:function(){this.noOfItems=Math.ceil(this.elements.items.length/this.options.noOfRows),this.noOfItems<this.itemsPerPage&&(this.noOfItems=this.itemsPerPage)},_setNoOfPages:function(){this.noOfPages=Math.ceil((this.noOfItems-this.itemsPerPage)/this._getitemsPerTransition())+1},_getitemsPerTransition:function(){return this.options.itemsPerTransition==="auto"?this.itemsPerPage:this.options.itemsPerTransition},_setRunnerWidth:function(){if(this.horizontal){var n=this.itemDim*this.noOfItems;this.elements.runner.width(n)}},_setLastPos:function(){var n=this.elements.items.eq(this.noOfItems-1);n.length&&(this.lastPos=n.position()[this.helperStr.pos]+this.itemDim-this.maskDim-parseInt(n.css("margin-"+this.helperStr.pos2),10))},_refreshPagination:function(){this.options.pagination&&(this.elements.prevAction.remove(),this.elements.pagination.remove(),this.elements.nextAction.remove(),this._setNoOfPages(),this._addPrevAction(),this._addPagination(),this._addNextAction())},goTo:function(t){this.itemIndex=typeof t=="number"?t:n(t).index(),this._go()},_addControlsOuterWrapper:function(){var t=this.elements;t.outerWrapper=n('<div class="outerWrapper" />'),t.mask.after(t.outerWrapper)},_addControlsWrapper:function(){var t=this.elements;t.wrapper=n('<div class="wrapper" />'),n(t.outerWrapper).find(".wrapper").length===0&&t.outerWrapper.append(t.wrapper)},_addPrevAction:function(){var i=this,t=this.elements;t.prevAction=n('<a href="#" class="prev"></a>').bind("click."+i.widgetName,function(){return i.prev(),gaCustom.trackCustomEvent("Image Gallery","Pagination Click","Prev"),!1}),t.prevAction.appendTo(t.wrapper)},_addPagination:function(){if(this.options.pagination){for(var r=this,i=this.elements,u=this.options,f=[],t=0;t<this.noOfPages;t++)f[t]='<li><a href="#item-'+t+'" >&nbsp;</a></li>';i.pagination=n('<ol class="pagination-links" />').append(f.join("")).delegate("a","click."+r.widgetName,function(){var t=this.hash.split("-")[1];return r.goTo(t*r._getitemsPerTransition()),gaCustom.trackCustomEvent("Image Gallery","Pagination Click","Page "+(parseInt(t)+1)),!1}),n.isFunction(u.insertPagination)?n.proxy(u.insertPagination,i.pagination)():i.pagination.appendTo(i.wrapper)}},_addNextAction:function(){var i=this,t=this.elements;t.nextAction=n('<a href="#" class="next"></a>').bind("click."+i.widgetName,function(){return i.next(),gaCustom.trackCustomEvent("Image Gallery","Pagination Click","Next"),!1}),t.nextAction.appendTo(t.wrapper)},next:function(){this.itemIndex=this.itemIndex+this._getitemsPerTransition(),this._go()},prev:function(){this.itemIndex=this.itemIndex-this._getitemsPerTransition(),this._go()},_updateUi:function(){var n=this.elements,i=this.itemIndex,r=this.noOfItems<=this.itemsPerPage,t;this.options.pagination&&(r?n.pagination.addClass("void"):n.pagination.children("li").removeClass("current").eq(Math.ceil(i/this._getitemsPerTransition())).addClass("current")),this.options.nextPrevActions&&(t=n.nextAction.add(n.prevAction),t.removeClass("disabled"),r?t.addClass("void"):(t.removeClass("void"),i===this.noOfItems-this.itemsPerPage?n.nextAction.addClass("disabled"):i===0&&n.prevAction.addClass("disabled")))},_go:function(){var t=this.elements,n;this.itemIndex>this.noOfItems-this.itemsPerPage&&(this.itemIndex=this.noOfItems-this.itemsPerPage),this.itemIndex<0&&(this.itemIndex=0),this._trigger("beforeAnimate",null,{index:this.itemIndex}),n=this.itemIndex*this.itemDim,this._slide(n),this._updateUi()},_slide:function(n){var i=this,r=this.elements,t={};n>this.lastPos&&(n=this.lastPos),t[this.helperStr.pos]=-n,r.runner.stop().animate(t,this.options.speed,this.options.easing,function(){i._trigger("afterAnimate",null,{index:i.itemIndex})})},_refresh:function(){this.itemIndex=0,this.elements.runner.css({left:"",top:""}),this._addClasses(),this._setMaskDim(),this._setItemDim(),this._setItemsPerPage(),this._setNoOfItems(),this._setRunnerWidth(),this._setMaskHeight(),this._setLastPos(),this._refreshPagination(),this._updateUi()},addItems:function(n){var t=this.elements;n.appendTo(t.runner),t.items=t.runner.children("li"),this._refresh()},_setOption:function(t,i){var r=this.elements,u=this.options;n.Widget.prototype._setOption.apply(this,arguments);switch(t){case"itemsPerPage":this._refresh();break;case"itemsPerTransition":this._refreshPagination(),this._updateUi();break;case"noOfRows":this.horizontal?this._refresh():u.noOfRows=1;break;case"unknownHeight":i?this._setMaskHeight():r.mask.height("");break;case"orientation":this._defineOrientation(),r.mask.height(""),r.runner.width(""),this._refresh();break;case"pagination":i&&!r.pagination?(this._addPagination(),this._updateUi()):!i&&r.pagination&&(r.pagination.remove(),r.pagination=null);break;case"nextPrevActions":i&&!r.nextAction?(this._addNextPrevActions(),this._updateUi()):!i&&r.nextAction&&(r.nextAction.remove(),r.nextAction=null,r.prevAction.remove(),r.prevAction=null)}},destroy:function(){var t=this.elements,i={};this.element.removeClass().addClass(this.oldClass),"maskAdded"in this?t.runner.unwrap(".mask"):t.mask.height(""),i[this.helperStr.pos]="",i[this.helperStr.dim]="",t.runner.css(i),t.pagination&&t.pagination.remove(),t.nextAction&&(t.nextAction.remove(),t.prevAction.remove()),n.each(t,function(){n(this).unbind("."+self.widgetName)}),n.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery),define("carousel",function(){}),function(n){n.fn.touchify=function(){var n=function(n){var f=n.changedTouches,t=f[0],r="",u,i;switch(n.type){case"touchstart":r="mousedown",i=!1;break;case"touchmove":r="mousemove",i=!0;break;case"touchend":r="mouseup",i=!1;break;default:return}u=document.createEvent("MouseEvent"),u.initMouseEvent(r,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(u),i};return this.each(function(){"ontouchstart"in document.documentElement&&(this.addEventListener("touchstart",n,!0),this.addEventListener("touchmove",n,!0),this.addEventListener("touchend",n,!0),this.addEventListener("touchcancel",n,!0))})}}(jQuery),define("touchify",function(){}),define("touchcarousel",["carousel","touchify"],function(){var n=$.ui.carousel.prototype;$.widget("ui.touchCarousel",$.ui.carousel,{options:{sensitivity:.8},_create:function(){n._create.apply(this);var t=this;this._setAxis(),this.elements.runner.touchify().draggable({axis:"x",start:function(n){n=n.originalEvent.touches?n.originalEvent.touches[0]:n,t._dragStartHandler(n)},stop:function(n){n=n.originalEvent.touches?n.originalEvent.touches[0]:n,t._dragStopHandler(n)}})},_setAxis:function(){this.axis=this.horizontal?"x":"y"},_dragStartHandler:function(n){this.startTime=this._getTime(),this.startPos={x:n.pageX,y:n.pageY}},_dragStopHandler:function(n){var u,t,r,i;this.endTime=this._getTime(),u=this.endTime-this.startTime,this.endPos={x:n.pageX,y:n.pageY},t=Math.abs(this.startPos[this.axis]-this.endPos[this.axis]),r=t/u,i=this.startPos[this.axis]>this.endPos[this.axis]?"next":"prev",r>this.options.sensitivity||t>this.itemDim*this._getitemsPerTransition()/2?this[i]():this.goTo(this.itemIndex)},_getTime:function(){var n=new Date;return n.getTime()},_setOption:function(t){n._setOption.apply(this,arguments);switch(t){case"orientation":this._setAxis(),this._switchAxis()}},_switchAxis:function(){this.elements.runner.draggable("option","axis",this.axis)},_destroy:function(){n._destroy.apply(this),this.elements.runner.draggable("destroy")}})}),define("imagegallery",["touchcarousel","touchify"],function(){$.fn.imagegallery=function(n){var t=$.extend({tilesInGalleryToShow:4,tilesInGalleryToScroll:4,mobileView:!1,gradient:!1,callback1:function(){},callback2:function(){}},n),i=$(".imageGalleryContainer");return this.each(function(){var n,r,f,s,o,u,e;$("body").hasClass("sfPageEditor")&&(t.tilesInGalleryToShow="4"),n=$(this),t.mobileView===!0?r=2:n.parents(".lo_2cols_1_67").length===1?(n.addClass("tabNested"),r=3):r=t.tilesInGalleryToShow,$("body").not(".sfPageEditor").addClass("hasImageGallery"),f=n.find(".tile").length;n.on("click",".tile",function(n){var t=$(n.currentTarget).index()+1;gaCustom.trackCustomEvent("Image Gallery","Tile Click","Page "+t)});if(n.find(".newsTiles").addClass("ui-carousel"),s=Math.round(n.width()/r),n.find(".tile").attr("style","width: "+s+"px !important"),o={init:function(n){this.elements={},this.elements.carousel=n.find(".ui-carousel");var u=this.elements,f=u.carousel,i={};i.itemsPerPage=$("body").hasClass("sfPageEditor")?r:t.mobileView?2:t.tilesInGalleryToScroll,f.touchCarousel(i)},destroy:function(n){this.elements={},this.elements.carousel=n.find(".ui-carousel");var u=this.elements,f=u.carousel,i={};i.itemsPerPage=$("body").hasClass("sfPageEditor")?r:t.mobileView?2:t.tilesInGalleryToScroll,f.touchCarousel("destroy")}},f>4)o.init(n);else if(r===2&&f>2||r===3&&f>3)o.init(n);else{try{o.destroy(n)}catch(h){}n.find(".ui-draggable").unbind("mousedown"),n.find(".mask").length===0&&n.wrapInner('<div class="mask"></div>')}setTimeout(function(){var t=n.find(".layout12").height();n.find(".mask").height(t)},500),$.isFunction(t.callback1)&&t.callback1.call(),u=0,e=n.find(".inner"),e.each(function(){$(this).height("auto")}),e.each(function(){u=Math.max($(this).height(),u)}),e.each(function(){$(this).height(u)}),t.gradient===!0&&n.find(".galleryGradient").length===0?(n.find(".mask").append('<span class="galleryGradient"></span>'),n.find(".galleryGradient").height(u+2)):n.find(".galleryGradient").length>0&&n.find(".galleryGradient").height(u+2),$.isFunction(t.callback2)&&t.callback2.call(),f<=r?n.find(".outerWrapper").hide():n.find(".outerWrapper").show(),i.removeClass("preInitState abbLoaderDrop")})}}),define("imagegalleryinit",["imagegallery"],function(){requirejs(["imagesloaded"],function(n){n($(".imageGalleryContainer"),function(){function n(){$(".imageGalleryContainer").imagegallery({mobileView:Site.isMobile,callback1:function(){Site.resizeHeightsOptimized()}})}n(),$(window).resize(function(){var t=0;clearTimeout(t),t=setTimeout(function(){n()},500)})}),n($(".carrouselLayout"),function(){function n(){$(".carrouselLayout").imagegallery({tilesInGalleryToShow:6,tilesInGalleryToScroll:6,mobileView:Site.isMobile,callback1:function(){Site.resizeHeightsOptimized()}})}n(),$(window).resize(function(){var t=0;clearTimeout(t),t=setTimeout(function(){n()},500)})}),$("body").hasClass("sfPageEditor")&&($(".imageGalleryContainer").removeClass("preInitState abbLoaderDrop"),$(".carrouselLayout").removeClass("preInitState abbLoaderDrop"))})});